body {
  article {
    /* prose with responsive font size */
    @apply prose max-w-none flex-grow break-words dark:prose-invert;
    @apply text-sm md:text-base;

    /* Japanese-optimized line height */
    line-height: 1.8;

    & p {
      /* Paragraph spacing */
      @apply my-5;
    }

    & ul {
      @apply list-disc pl-5;
    }
    & ol {
      @apply list-decimal pl-5;
    }
    & li {
      @apply list-outside;
      /* Comfortable spacing between list items */
      @apply my-1.5;
    }

    /* Heading hierarchy - mobile-first sizing */
    & h1,
    & h2,
    & h3,
    & h4,
    & h5,
    & h6 {
      text-wrap: wrap;
      word-break: normal;
    }
    & h1 {
      @apply mb-5 mt-10 font-heading text-foreground;
      @apply text-xl md:text-2xl;
      font-weight: 700;
      letter-spacing: -0.01em;
    }
    & h2 {
      @apply mb-3 mt-8 font-heading text-foreground;
      @apply text-lg md:text-xl;
      font-weight: 600;
    }
    & h3 {
      @apply mb-2 mt-6 font-heading text-foreground;
      @apply text-base md:text-lg;
      font-weight: 600;
    }
    & h4 {
      @apply mb-2 mt-5 font-heading text-foreground;
      @apply text-sm md:text-base;
      font-weight: 600;
    }
    & h5 {
      @apply mb-1 mt-4 font-heading text-foreground;
      @apply text-sm;
      font-weight: 500;
    }
    & h6 {
      @apply mb-1 mt-3 font-heading text-foreground;
      @apply text-xs md:text-sm;
      font-weight: 500;
    }
    h2,
    h3,
    h4,
    h5,
    h6 {
      a > span.heading-link-icon {
        &:after {
          content: '#';
          @apply ml-2 text-base text-muted-foreground transition-colors duration-fast;
          opacity: 0.4;
        }
      }
      &:hover {
        a > span.heading-link-icon {
          &:after {
            opacity: 1;
          }
        }
      }
    }
    & a {
      @apply text-link underline-offset-2 transition-colors duration-fast;
      &:hover {
        @apply text-link-hover;
      }
    }
    & code {
      @apply rounded bg-muted px-1.5 py-0.5 font-code text-xs md:text-sm;
    }
    /* Hide literal backticks in inline code rendered by rehype-pretty-code */
    & p code,
    & li code,
    & td code {
      &::before,
      &::after {
        content: none !important;
      }
    }
    & pre {
      @apply my-5 overflow-x-auto rounded-md text-xs md:text-sm;
    }
    & blockquote {
      @apply my-5 rounded-r-md border-l-2 border-border bg-muted py-3 pl-4 pr-3 not-italic text-muted-foreground;
    }
    & .footnotes {
      @apply mt-8 border-t border-border pt-5 text-xs text-muted-foreground md:text-sm;
      & li {
        @apply list-outside;
      }
      & .data-footnote-backref {
        text-decoration: none;
      }
    }

    /* Tables - responsive with better styling */
    & table {
      @apply my-5 w-full text-xs md:text-sm;
    }
    & th {
      @apply bg-muted px-2 py-2 text-left font-medium md:px-3;
    }
    & td {
      @apply border-t border-border px-2 py-2 md:px-3;
    }

    /* Images and figures */
    & img {
      @apply my-5 rounded-md;
    }

    /* YouTube embed (astro-embed lite-youtube) */
    & lite-youtube {
      @apply my-8 w-full max-w-none rounded-md;
      /* Prevent CLS by reserving space for 16:9 video */
      aspect-ratio: 16 / 9;
    }
    & figure {
      @apply my-5;
      & img {
        @apply my-0;
      }
      & figcaption {
        @apply mt-2 text-center text-xs text-muted-foreground;
      }
    }
  }
}
