@reference "./tokens.css";

/* WCAG 2.1 focus indicators */
:focus-visible {
  @apply ring-ring ring-2 ring-offset-2 outline-none;
  ring-offset-color: var(--color-background);
}

body {
  article {
    /* prose with responsive font size */
    @apply prose dark:prose-invert max-w-none flex-grow break-words;
    @apply text-sm md:text-base;

    /* Japanese-optimized line height */
    line-height: 1.8;

    & p {
      @apply my-5;
    }

    & ul {
      @apply list-disc pl-5;
    }
    & ol {
      @apply list-decimal pl-5;
    }
    & li {
      @apply list-outside;
      @apply my-1.5;
    }

    /* Heading hierarchy */
    & h1,
    & h2,
    & h3,
    & h4,
    & h5,
    & h6 {
      text-wrap: wrap;
      word-break: normal;
    }
    & h1 {
      @apply font-heading text-foreground mt-10 mb-5;
      @apply text-xl md:text-2xl;
      font-weight: 700;
      letter-spacing: -0.01em;
    }
    & h2 {
      @apply font-heading text-foreground mt-8 mb-3;
      @apply text-lg md:text-xl;
      font-weight: 600;
    }
    & h3 {
      @apply font-heading text-foreground mt-6 mb-2;
      @apply text-base md:text-lg;
      font-weight: 600;
    }
    & h4 {
      @apply font-heading text-foreground mt-5 mb-2;
      @apply text-sm md:text-base;
      font-weight: 600;
    }
    & h5 {
      @apply font-heading text-foreground mt-4 mb-1;
      @apply text-sm;
      font-weight: 500;
    }
    & h6 {
      @apply font-heading text-foreground mt-3 mb-1;
      @apply text-xs md:text-sm;
      font-weight: 500;
    }
    h2,
    h3,
    h4,
    h5,
    h6 {
      a > span.heading-link-icon {
        &:after {
          content: '#';
          @apply text-muted-foreground ml-2 text-base transition-colors;
          transition-duration: var(--duration-fast);
          opacity: 0.4;
        }
      }
      &:hover {
        a > span.heading-link-icon {
          &:after {
            opacity: 1;
          }
        }
      }
    }
    & a {
      @apply text-link underline decoration-transparent underline-offset-3 transition-[color,text-decoration-color];
      transition-duration: var(--duration-fast);
      &:hover {
        @apply text-link-hover decoration-current;
      }
    }
    & code {
      @apply bg-muted font-code rounded px-1.5 py-0.5 text-xs md:text-sm;
    }
    & p code,
    & li code,
    & td code {
      &::before,
      &::after {
        content: none !important;
      }
    }
    & pre {
      @apply my-5 overflow-x-auto rounded-md text-xs md:text-sm;
    }
    & blockquote {
      @apply border-border bg-muted text-muted-foreground my-5 rounded-r-md border-l-2 py-3 pr-3 pl-4 not-italic;
    }
    & .footnotes {
      @apply border-border text-muted-foreground mt-8 border-t pt-5 text-xs md:text-sm;
      & .data-footnote-backref {
        text-decoration: none;
      }
    }

    /* Tables */
    & table {
      @apply my-5 w-full text-xs md:text-sm;
    }
    & th {
      @apply bg-muted px-2 py-2 text-left font-medium md:px-3;
    }
    & td {
      @apply border-border border-t px-2 py-2 md:px-3;
    }

    /* Images and figures */
    & img {
      @apply my-5 rounded-md;
    }

    /* YouTube embed (astro-embed lite-youtube) */
    & lite-youtube {
      @apply my-8 w-full max-w-none rounded-md;
      aspect-ratio: 16 / 9;
    }
    & figure {
      @apply my-5;
      & img {
        @apply my-0;
      }
      & figcaption {
        @apply text-muted-foreground mt-2 text-center text-xs;
      }
    }
  }
}
