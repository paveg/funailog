---
import { getEntry } from 'astro:content';

import CertificationsSection from '@/components/portfolio/CertificationsSection.astro';
import CVExportButton from '@/components/portfolio/CVExportButton.astro';
import EducationSection from '@/components/portfolio/EducationSection.astro';
import ProfileSection from '@/components/portfolio/ProfileSection.astro';
import ProjectsSection from '@/components/portfolio/ProjectsSection.astro';
import SkillsSection from '@/components/portfolio/SkillsSection.astro';
import WorkExperienceSection from '@/components/portfolio/WorkExperienceSection.astro';
import { useTranslations } from '@/i18n/utils';
import Layout from '@/layouts/Layout.astro';

const t = useTranslations('ja');
const portfolio = await getEntry('portfolio', 'profile');

if (!portfolio) {
  throw new Error('Portfolio data not found');
}
---

<Layout
  title={`Portfolio | ${t('main.title')}`}
  description={t('portfolio.description')}
  path="/portfolio"
  og={{ enabled: true }}
  hreflangs={[
    { path: '/portfolio', hreflang: 'ja' },
    { path: '/en/portfolio', hreflang: 'en' },
    { path: '/portfolio', hreflang: 'x-default' },
  ]}
>
  <div class="space-y-12">
    <div class="flex justify-end">
      <a
        href="/en/portfolio"
        class="font-code text-muted-foreground hover:text-foreground text-xs transition-colors"
      >
        English &rarr;
      </a>
    </div>

    <ProfileSection profile={portfolio.data.profile} />

    <CVExportButton />

    <WorkExperienceSection items={portfolio.data.workExperience} />

    <ProjectsSection items={portfolio.data.projects} />

    <SkillsSection items={portfolio.data.skills} />

    {
      portfolio.data.certifications &&
        portfolio.data.certifications.length > 0 && (
          <CertificationsSection items={portfolio.data.certifications} />
        )
    }

    {
      portfolio.data.education && portfolio.data.education.length > 0 && (
        <EducationSection items={portfolio.data.education} />
      )
    }
  </div>
</Layout>
