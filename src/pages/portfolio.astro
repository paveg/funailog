---
import { getEntry } from 'astro:content';

import CertificationsSection from '@/components/portfolio/CertificationsSection.astro';
import CVExportButton from '@/components/portfolio/CVExportButton.astro';
import EducationSection from '@/components/portfolio/EducationSection.astro';
import ProfileSection from '@/components/portfolio/ProfileSection.astro';
import ProjectsSection from '@/components/portfolio/ProjectsSection.astro';
import SkillsSection from '@/components/portfolio/SkillsSection.astro';
import WorkExperienceSection from '@/components/portfolio/WorkExperienceSection.astro';
import { useTranslations } from '@/i18n/utils';
import Layout from '@/layouts/Layout.astro';

const t = useTranslations('ja');
const portfolio = await getEntry('portfolio', 'profile');

if (!portfolio) {
  throw new Error('Portfolio data not found');
}
---

<Layout
  title={`Portfolio | ${t('main.title')}`}
  description={t('portfolio.description')}
  path="/portfolio"
  og={{ enabled: true }}
  hreflangs={[
    { path: '/portfolio', hreflang: 'ja' },
    { path: '/en/portfolio', hreflang: 'en' },
    { path: '/portfolio', hreflang: 'x-default' },
  ]}
>
  <main class="space-y-12">
    <div class="flex items-center justify-between">
      <div></div>
      <a
        href="/en/portfolio"
        class="border-border/60 text-muted-foreground hover:bg-accent hover:text-accent-foreground inline-flex items-center gap-1.5 rounded-md border px-3 py-1.5 text-sm transition-colors"
      >
        <svg
          xmlns="http://www.w3.org/2000/svg"
          class="size-4"
          viewBox="0 0 24 24"
          fill="none"
          stroke="currentColor"
          stroke-width="2"
          stroke-linecap="round"
          stroke-linejoin="round"
        >
          <circle cx="12" cy="12" r="10"></circle>
          <path
            d="M12 2a15.3 15.3 0 0 1 4 10 15.3 15.3 0 0 1-4 10 15.3 15.3 0 0 1-4-10 15.3 15.3 0 0 1 4-10z"
          ></path>
          <path d="M2 12h20"></path>
        </svg>
        English
      </a>
    </div>

    <ProfileSection profile={portfolio.data.profile} />

    <CVExportButton />

    <WorkExperienceSection items={portfolio.data.workExperience} />

    <ProjectsSection items={portfolio.data.projects} />

    <SkillsSection items={portfolio.data.skills} />

    {
      portfolio.data.certifications &&
        portfolio.data.certifications.length > 0 && (
          <CertificationsSection items={portfolio.data.certifications} />
        )
    }

    {
      portfolio.data.education && portfolio.data.education.length > 0 && (
        <EducationSection items={portfolio.data.education} />
      )
    }
  </main>
</Layout>
