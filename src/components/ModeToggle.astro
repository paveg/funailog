---
/**
 * ModeToggle - Pure Astro component for theme switching
 * Eliminates React hydration overhead and useLayoutEffect blocking
 */
---

<button
  id="theme-toggle"
  type="button"
  class="text-foreground ring-offset-background hover:bg-accent hover:text-accent-foreground focus-visible:ring-ring inline-flex size-8 items-center justify-center rounded-md text-sm font-medium transition-colors focus-visible:ring-2 focus-visible:ring-offset-2 focus-visible:outline-none"
  aria-label="Toggle theme"
>
  <span class="sr-only">Toggle mode</span>
  {/* Sun icon - shown in light mode */}
  <svg
    id="sun-icon"
    xmlns="http://www.w3.org/2000/svg"
    class="hidden size-4 dark:block"
    viewBox="0 0 15 15"
    fill="currentColor"
  >
    <path
      d="M7.5 0a.5.5 0 0 1 .5.5v2a.5.5 0 0 1-1 0v-2a.5.5 0 0 1 .5-.5ZM2.197 2.197a.5.5 0 0 1 .707 0L4.318 3.61a.5.5 0 0 1-.707.707L2.197 2.904a.5.5 0 0 1 0-.707ZM.5 7a.5.5 0 0 0 0 1h2a.5.5 0 0 0 0-1h-2Zm1.697 5.803a.5.5 0 0 1 0-.707l1.414-1.414a.5.5 0 1 1 .707.707l-1.414 1.414a.5.5 0 0 1-.707 0ZM7.5 12a.5.5 0 0 1 .5.5v2a.5.5 0 0 1-1 0v-2a.5.5 0 0 1 .5-.5Zm3.182-1.682a.5.5 0 0 1 .707 0l1.414 1.414a.5.5 0 0 1-.707.707l-1.414-1.414a.5.5 0 0 1 0-.707ZM12 7.5a.5.5 0 0 1 .5-.5h2a.5.5 0 0 1 0 1h-2a.5.5 0 0 1-.5-.5Zm-.318-3.89a.5.5 0 0 1 0 .708l-1.414 1.414a.5.5 0 1 1-.707-.707l1.414-1.414a.5.5 0 0 1 .707 0ZM7.5 4a3.5 3.5 0 1 0 0 7 3.5 3.5 0 0 0 0-7Z"
    ></path>
  </svg>
  {/* Moon icon - shown in dark mode */}
  <svg
    id="moon-icon"
    xmlns="http://www.w3.org/2000/svg"
    class="block size-4 dark:hidden"
    viewBox="0 0 15 15"
    fill="currentColor"
  >
    <path
      d="M2.89998 0.499976C2.89998 0.279062 2.72089 0.0999756 2.49998 0.0999756C2.27906 0.0999756 2.09998 0.279062 2.09998 0.499976V1.09998H1.49998C1.27906 1.09998 1.09998 1.27906 1.09998 1.49998C1.09998 1.72089 1.27906 1.89998 1.49998 1.89998H2.09998V2.49998C2.09998 2.72089 2.27906 2.89998 2.49998 2.89998C2.72089 2.89998 2.89998 2.72089 2.89998 2.49998V1.89998H3.49998C3.72089 1.89998 3.89998 1.72089 3.89998 1.49998C3.89998 1.27906 3.72089 1.09998 3.49998 1.09998H2.89998V0.499976ZM5.89998 3.49998C5.89998 3.27906 5.72089 3.09998 5.49998 3.09998C5.27906 3.09998 5.09998 3.27906 5.09998 3.49998V4.09998H4.49998C4.27906 4.09998 4.09998 4.27906 4.09998 4.49998C4.09998 4.72089 4.27906 4.89998 4.49998 4.89998H5.09998V5.49998C5.09998 5.72089 5.27906 5.89998 5.49998 5.89998C5.72089 5.89998 5.89998 5.72089 5.89998 5.49998V4.89998H6.49998C6.72089 4.89998 6.89998 4.72089 6.89998 4.49998C6.89998 4.27906 6.72089 4.09998 6.49998 4.09998H5.89998V3.49998ZM1.89998 6.49998C1.89998 6.27906 1.72089 6.09998 1.49998 6.09998C1.27906 6.09998 1.09998 6.27906 1.09998 6.49998V7.09998H0.499976C0.279062 7.09998 0.0999756 7.27906 0.0999756 7.49998C0.0999756 7.72089 0.279062 7.89998 0.499976 7.89998H1.09998V8.49998C1.09998 8.72089 1.27906 8.89998 1.49998 8.89998C1.72089 8.89998 1.89998 8.72089 1.89998 8.49998V7.89998H2.49998C2.72089 7.89998 2.89998 7.72089 2.89998 7.49998C2.89998 7.27906 2.72089 7.09998 2.49998 7.09998H1.89998V6.49998ZM8.54406 0.982181C8.28902 0.932406 8.03327 1.06212 7.92899 1.29666C7.82472 1.53121 7.89666 1.81025 8.09669 1.96891L8.10002 1.97154L8.10679 1.97633C8.11202 1.97997 8.11991 1.98531 8.13039 1.99233C8.15135 2.00639 8.18198 2.02676 8.22052 2.05335C8.29767 2.10658 8.40425 2.18396 8.53143 2.28615C8.78625 2.49081 9.11799 2.79894 9.44604 3.21619C10.1 4.04836 10.7413 5.3233 10.7413 7.0001C10.7413 8.55913 10.1733 9.77902 9.55127 10.6277C9.23943 11.0535 8.92329 11.3877 8.67904 11.6175C8.55677 11.7326 8.45389 11.8224 8.37977 11.8863C8.34271 11.9182 8.31311 11.9426 8.29213 11.9594C8.28164 11.9678 8.27339 11.9743 8.26754 11.979L8.26196 11.9833L8.26006 11.9848L8.25956 11.9852L8.2594 11.9853C8.2594 11.9853 8.25938 11.9853 8.54406 12.1521L8.2594 11.9853C8.07013 12.1557 8.0131 12.4262 8.11813 12.6567C8.22315 12.8873 8.46543 13.0293 8.72 12.9999C10.2379 12.8124 11.4921 12.0927 12.3856 11.0917C13.2784 10.0913 13.8504 8.77551 13.8504 7.0001C13.8504 5.22455 13.2782 3.9087 12.385 2.90825C11.4911 1.90706 10.2367 1.18728 8.71831 1.00008C8.66323 0.993802 8.60299 0.990195 8.54406 0.982181Z"
    ></path>
  </svg>
</button>

<script>
  function initThemeToggle() {
    const button = document.getElementById('theme-toggle');
    if (!button) return;

    button.addEventListener('click', () => {
      const isDark = document.documentElement.classList.contains('dark');
      const newTheme = isDark ? 'light' : 'dark';

      if (newTheme === 'dark') {
        document.documentElement.classList.add('dark');
      } else {
        document.documentElement.classList.remove('dark');
      }

      localStorage.setItem('theme', newTheme);
    });
  }

  // Run on initial load
  initThemeToggle();

  // Re-run after Astro page transitions
  document.addEventListener('astro:after-swap', initThemeToggle);
</script>
