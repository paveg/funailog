---
import LinkCard from '@/components/LinkCard.astro';
import { cn, linkStyles } from '@/lib/utils';

type Props = {
  href: string;
  ['data-linkcard']?: string;
};

const props = Astro.props;
const isInternal = props.href.startsWith('/');
const isAnchor = props.href.startsWith('#');
const linkClass = cn(linkStyles.base, linkStyles.inline);
---

{
  Object.hasOwn(props, 'data-linkcard') ? (
    <LinkCard {...props}>
      <slot />
    </LinkCard>
  ) : isAnchor || isInternal ? (
    <a href={props.href} class={linkClass}>
      <slot />
    </a>
  ) : (
    <a
      target="_blank"
      rel="noopener noreferrer"
      href={props.href}
      class:list={[linkClass, 'external-link']}
      aria-label={`${props.href} (外部リンク)`}
    >
      <slot />
    </a>
  )
}

<style>
  .external-link::after {
    content: '\2197';
    font-size: 0.65em;
    margin-left: 0.15em;
    opacity: 0.5;
  }
</style>
